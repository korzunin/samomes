(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ff64aa8"],{1648:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{staticClass:"mb-12"},[s("v-row",[s("page-title",[e._v(" Расписание ")]),s("guide",[e._v(" На этой странице можно составить расписание внесения удобрений в аквариум. "),s("br"),s("br"),e._v(" Калькулятор сам рассчитает концентрации элементов, по которым можно прикинуть дозировки вносимых удобрений. А так же предложит составить расписание. ")]),0===e.schedules.length?s("v-col",{attrs:{cols:"12",md:"8","offset-md":"2"}},[s("p",{staticClass:"mb-8",class:{"text-h6":e.$vuetify.breakpoint["xs"],"text-h5":e.$vuetify.breakpoint["smAndUp"]}},[e._v(" У вас нет ни одного расписания ")])]):e._e(),s("v-col",{attrs:{cols:"12",md:"8","offset-md":"2"}},e._l(e.schedules,(function(e,t){return s("Schedule",{key:t,attrs:{"schedule-index":t}})})),1)],1),s("add-button",{attrs:{action:e.openAddSchedule}},[e._v(" Добавить расписание ")])],1)},a=[],n=s("5530"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{staticClass:"mb-2"},[s("v-card-title",{staticClass:"headline d-flex justify-space-between align-start flex-nowrap"},[s("div",{staticClass:"no-break"},[e._v(" "+e._s(e.schedule.tank.name)+" ")])]),s("v-card-subtitle",[s("span",[e._v("Объем: "+e._s(e.schedule.tank.volume)+" л")])]),s("v-card-text",[s("v-stepper",{attrs:{"alt-labels":""},model:{value:e.activeIndex,callback:function(t){e.activeIndex=t},expression:"activeIndex"}},[s("v-stepper-items",[[e.FERTILIZATION_IN_TAP_WATER,e.FERTILIZATION_MIX].includes(e.fertilizationType)?s("v-stepper-content",{staticClass:"pa-0 pb-8",attrs:{step:1}},[s("div",{staticClass:"d-flex flex-column text-h4 text-center mb-4"},[s("div",[s("span",{staticStyle:{"text-transform":"capitalize"}},[e._v(e._s(e.schedule.datesColumn[0].weekday))]),e._v(", "),s("span",[e._v(e._s(e.schedule.datesColumn[0].date))])]),s("div",{staticClass:"text-center text-body-1"},[e._v(" Подмена ")])]),[e.FERTILIZATION_IN_TAP_WATER,e.FERTILIZATION_MIX].includes(e.schedule.fertilizationType)?s("div",e._l(e.waterChangeQuotas,(function(t,i){return s("div",{key:"water_change_"+i},[s("v-row",[s("v-col",{staticClass:"py-1",attrs:{cols:"12",sm:"10","offset-sm":"1"}},[s("schedule-button",{attrs:{disabled:0===t,status:e.schedule.completedWaterChange[i],value:t,sum:e.totalSum[i]["sum"],amount:e.totalSum[i]["amount"],"recipe-name":i},on:{click:function(t){return e.clickWaterChangeDay(i)}}},[e._v(" "+e._s(i)+" ")])],1)],1)],1)})),0):e._e()]):e._e(),e.fertilizationType!==e.FERTILIZATION_IN_TAP_WATER?e._l(e.slidesNumbers,(function(t,i){return s("v-stepper-content",{key:t+"-content",staticClass:"pa-0 pb-8",attrs:{step:t}},[s("div",{staticClass:"d-flex flex-column text-h4 text-center mb-4"},[s("div",[s("span",{staticStyle:{"text-transform":"capitalize"}},[e._v(e._s(e.schedule.datesColumn[i].weekday))]),e._v(", "),s("span",[e._v(e._s(e.schedule.datesColumn[i].date))])]),s("div",{staticClass:"text-center text-body-1"},[e._v(" "+e._s(e._f("format")(e.schedule.datesRange[0],"DD MMMM"))+" - "+e._s(e._f("format")(e.schedule.datesRange[1],"DD MMMM"))+" ")])]),e._l(e.daysQuotas,(function(a,n){return s("div",{key:n+t},[s("v-row",[s("v-col",{staticClass:"py-1",attrs:{cols:"12",sm:"10","offset-sm":"1"}},[s("schedule-button",{attrs:{disabled:!e.schedule.selected[n][i]||null===e.daysQuotas[n][i],status:e.schedule.completed[n][i],value:a[i],sum:e.totalSum[n]["sum"],amount:e.totalSum[n]["amount"],"recipe-name":n},on:{click:function(t){return e.clickDay(i,n)}}})],1)],1)],1)}))],2)})):e._e()],2)],1)],1),s("v-card-actions",[s("v-btn",{staticClass:"ml-auto",attrs:{text:"",disabled:e.activeIndex<=1},on:{click:e.prevStep}},[e._v(" Назад ")]),s("v-btn",{staticClass:"ml-0 ml-sm-3",attrs:{text:"",disabled:e.activeIndex===e.slidesTotal},on:{click:e.nextStep}},[e._v(" Далее ")]),s("v-btn",{staticClass:"ml-0 ml-sm-3",attrs:{text:""},on:{click:function(t){return e.$router.push("/schedules/"+e.scheduleIndex)}}},[e._v(" Открыть ")])],1),s("v-progress-linear",{attrs:{value:e.progressValue}})],1)},c=[],l=s("2909"),o=(s("a9e3"),s("fb6a"),s("b64b"),s("159b"),s("b0c0"),s("4de4"),s("cb29"),s("c740"),s("da09")),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-btn",e._g({staticClass:"mb-2 px-3",staticStyle:{"max-width":"100%"},attrs:{disabled:e.disabled,block:"","x-large":"",tile:"",color:["primary","primary","grey"][e.status],outlined:[!0,!1,!0][e.status]},scopedSlots:e._u([{key:"default",fn:function(){return[s("div",{staticClass:"d-flex align-center w-100"},[s("v-icon",{attrs:{color:["primary","white","grey"][e.status]}},[e._v(" "+e._s(["far fa-circle","far fa-check-circle","far fa-times-circle"][e.status])+" ")]),s("div",{staticClass:"d-flex justify-start justify-sm-center text-truncate flex-grow-1 text-subtitle-2\n               text-sm-h6 font-weight-regular mx-2"},[s("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis",position:"relative",top:"1px"}},[e._v(" "+e._s(e.recipeName)+" ")])]),s("div",{staticClass:"d-flex flex-column align-end flex-shrink-1 ml-auto"},[""!==e.value?s("div",{staticClass:"text-h6 text-sm-h5"},[e._v(" "+e._s(+e.value?e.value.toFixed(1):"")+" ")]):s("div",{staticClass:"text-h6 text-sm-h5"},[e._v(" - ")]),s("div",{staticClass:"d-none d-sm-block caption mt-n2"},[e._v(" "+e._s(e.sum)+" / "+e._s(e.amount)+" ")])])],1)]},proxy:!0}])},e.$listeners))},d=[],p={name:"ScheduleButton",props:{recipeName:{type:String,default:""},disabled:{type:Boolean,default:!1},status:{type:Number,default:0},value:{type:[String,Number],default:0},sum:{type:Number,default:0},amount:{type:[String,Number],default:0}}},h=p,f=s("2877"),v=s("6544"),m=s.n(v),b=s("8336"),_=s("132d"),y=Object(f["a"])(h,u,d,!1,null,"5656b56d",null),I=y.exports;m()(y,{VBtn:b["a"],VIcon:_["a"]});var T=s("2f62"),g={name:"Schedule",components:{ScheduleButton:I},props:{scheduleIndex:{type:[String,Number],default:0}},data:function(){return{activeIndex:1,FERTILIZATION_IN_TAP_WATER:o["b"],FERTILIZATION_EVERY_DAY:o["a"],FERTILIZATION_MIX:o["c"]}},created:function(){this.activeIndex=this.findCurActiveDay()},computed:Object(n["a"])(Object(n["a"])({},Object(T["d"])(["schedules"])),{},{schedule:function(){return this.schedules[this.scheduleIndex]},fertilizationType:function(){return this.schedule.fertilizationType||o["a"]},slidesTotal:function(){var e=this.schedule.daysTotal;return this.fertilizationType===o["c"]&&(e+=1),e},slidesNumbers:function(){var e,t=this.schedule.daysTotal;return e=this.fertilizationType===o["c"]?Object.keys(Object(l["a"])(Array(t+2))).slice(2):Object.keys(Object(l["a"])(Array(t+1))).slice(1),e},waterChangeQuotas:function(){var e={};return this.schedule.recipesSelected.forEach((function(t){e[t.name]=t.amount||0})),e},daysQuotas:function(){var e=this;if(this.fertilizationType===o["b"])return{};var t={};return this.schedule.recipesSelected.forEach((function(s){var i=[],a=e.schedule.selected[s.name],n=e.schedule.completed[s.name],r=a.filter((function(e){return!1===e})).length,c=e.schedule.daysTotal-r,o=s.amountDay*e.schedule.daysTotal,u=o/(e.schedule.daysTotal-r);Object.keys(Object(l["a"])(Array(e.schedule.daysTotal))).forEach((function(e){if(o){switch(!0){case 1===n[e]:u=o/c,o-=u,c-=1;break;case!a[e]:u=0;break;case 2===n[e]:u=0,c-=1;break;default:u=o/c}i.push(u)}else i.push(null)})),t[s.name]=i})),t},totalSum:function(){var e=this,t={};return this.schedule.recipesSelected.forEach((function(s){var i,a=0;switch(e.fertilizationType!==o["b"]&&Object.keys(e.daysQuotas[s.name]).forEach((function(t){if(e.schedule.completed[s.name][t]){var i=e.daysQuotas[s.name][t];null!==i&&(a+=i)}})),e.fertilizationType!==o["a"]&&e.schedule.completedWaterChange[s.name]&&(a+=e.waterChangeQuotas[s.name]),!0){case e.fertilizationType===o["c"]:i=s.amount+s.amountDay*e.schedule.daysTotal;break;case e.fertilizationType===o["b"]:i=s.amount;break;default:i=s.amountDay*e.schedule.daysTotal}t[s.name]={sum:a,amount:i}})),t},isCompletedDay:function(){var e=this,t=Array(this.schedule.daysTotal).fill(!1);return t.forEach((function(s){var i=0;Object.keys(e.schedule.selected).forEach((function(t){var a=e.schedule.completed[t][s],n=e.schedule.selected[t][s];n&&1!==a&&2!==a||(i+=1)})),i===Object.keys(e.schedule.completed).length&&(0===parseInt(s,10)||t[s-1])&&(t[s]=!0)})),t},progressValue:function(){var e=this,t=0,s=0;return Object.keys(this.totalSum).forEach((function(i){s+=parseFloat(e.totalSum[i].amount),t+=parseFloat(e.totalSum[i].sum)})),t/s*100}}),methods:Object(n["a"])(Object(n["a"])({},Object(T["c"])(["SCHEDULE_COMPLETE","SCHEDULE_COMPLETE_WATER_CHANGE"])),{},{clickDay:function(e,t){this.SCHEDULE_COMPLETE({scheduleIndex:this.scheduleIndex,dayIndex:e,recipeName:t})},clickWaterChangeDay:function(e){this.SCHEDULE_COMPLETE_WATER_CHANGE({scheduleIndex:this.scheduleIndex,recipeName:e})},prevStep:function(){this.activeIndex>1&&(this.activeIndex-=1)},nextStep:function(){this.activeIndex<this.slidesTotal&&(this.activeIndex+=1)},findCurActiveDay:function(){var e=Object(l["a"])(this.isCompletedDay);e.reverse();var t=e.findIndex((function(e){return!0===e}));t=-1===t?e.length:t;var s=e.length-t+1;return s>e.length&&(s=e.length),s}})},x=g,E=(s("9a92"),s("b0af")),C=s("99d9"),A=s("62ad"),O=s("8e36"),S=s("0fd9"),N=(s("0481"),s("8836"),s("10d2")),R=s("3206"),k=s("a452"),w=s("58df"),j=s("d9bd"),V=Object(w["a"])(N["a"],Object(R["b"])("stepper"),k["a"]),L=V.extend({name:"v-stepper",provide:function(){return{stepClick:this.stepClick,isVertical:this.vertical}},props:{altLabels:Boolean,nonLinear:Boolean,flat:Boolean,vertical:Boolean},data:function(){var e={isBooted:!1,steps:[],content:[],isReverse:!1};return e.internalLazyValue=null!=this.value?this.value:(e[0]||{}).step||1,e},computed:{classes:function(){return Object(n["a"])({"v-stepper--flat":this.flat,"v-stepper--is-booted":this.isBooted,"v-stepper--vertical":this.vertical,"v-stepper--alt-labels":this.altLabels,"v-stepper--non-linear":this.nonLinear},N["a"].options.computed.classes.call(this))},styles:function(){return Object(n["a"])({},N["a"].options.computed.styles.call(this))}},watch:{internalValue:function(e,t){this.isReverse=Number(e)<Number(t),t&&(this.isBooted=!0),this.updateView()}},created:function(){this.$listeners.input&&Object(j["a"])("@input","@change",this)},mounted:function(){this.updateView()},methods:{register:function(e){"v-stepper-step"===e.$options.name?this.steps.push(e):"v-stepper-content"===e.$options.name&&(e.isVertical=this.vertical,this.content.push(e))},unregister:function(e){"v-stepper-step"===e.$options.name?this.steps=this.steps.filter((function(t){return t!==e})):"v-stepper-content"===e.$options.name&&(e.isVertical=this.vertical,this.content=this.content.filter((function(t){return t!==e})))},stepClick:function(e){var t=this;this.$nextTick((function(){return t.internalValue=e}))},updateView:function(){for(var e=this.steps.length;--e>=0;)this.steps[e].toggle(this.internalValue);for(var t=this.content.length;--t>=0;)this.content[t].toggle(this.internalValue,this.isReverse)}},render:function(e){return e(this.tag,{staticClass:"v-stepper",class:this.classes,style:this.styles},this.$slots.default)}}),$=(s("d3b7"),s("25f0"),s("0789")),z=s("80d2"),F=Object(w["a"])(Object(R["a"])("stepper","v-stepper-content","v-stepper")),D=F.extend().extend({name:"v-stepper-content",inject:{isVerticalProvided:{from:"isVertical"}},props:{step:{type:[Number,String],required:!0}},data:function(){return{height:0,isActive:null,isReverse:!1,isVertical:this.isVerticalProvided}},computed:{computedTransition:function(){var e=this.$vuetify.rtl?!this.isReverse:this.isReverse;return e?$["g"]:$["h"]},styles:function(){return this.isVertical?{height:Object(z["f"])(this.height)}:{}}},watch:{isActive:function(e,t){e&&null==t?this.height="auto":this.isVertical&&(this.isActive?this.enter():this.leave())}},mounted:function(){this.$refs.wrapper.addEventListener("transitionend",this.onTransition,!1),this.stepper&&this.stepper.register(this)},beforeDestroy:function(){this.$refs.wrapper.removeEventListener("transitionend",this.onTransition,!1),this.stepper&&this.stepper.unregister(this)},methods:{onTransition:function(e){this.isActive&&"height"===e.propertyName&&(this.height="auto")},enter:function(){var e=this,t=0;requestAnimationFrame((function(){t=e.$refs.wrapper.scrollHeight})),this.height=0,setTimeout((function(){return e.isActive&&(e.height=t||"auto")}),450)},leave:function(){var e=this;this.height=this.$refs.wrapper.clientHeight,setTimeout((function(){return e.height=0}),10)},toggle:function(e,t){this.isActive=e.toString()===this.step.toString(),this.isReverse=t}},render:function(e){var t={staticClass:"v-stepper__content"},s={staticClass:"v-stepper__wrapper",style:this.styles,ref:"wrapper"};this.isVertical||(t.directives=[{name:"show",value:this.isActive}]);var i=e("div",s,[this.$slots.default]),a=e("div",t,[i]);return e(this.computedTransition,{on:this.$listeners},[a])}}),Z=s("9d26"),M=s("a9ad"),P=s("5607"),W=Object(w["a"])(M["a"],Object(R["a"])("stepper","v-stepper-step","v-stepper")),B=(W.extend().extend({name:"v-stepper-step",directives:{ripple:P["a"]},inject:["stepClick"],props:{color:{type:String,default:"primary"},complete:Boolean,completeIcon:{type:String,default:"$complete"},editable:Boolean,editIcon:{type:String,default:"$edit"},errorIcon:{type:String,default:"$error"},rules:{type:Array,default:function(){return[]}},step:[Number,String]},data:function(){return{isActive:!1,isInactive:!0}},computed:{classes:function(){return{"v-stepper__step--active":this.isActive,"v-stepper__step--editable":this.editable,"v-stepper__step--inactive":this.isInactive,"v-stepper__step--error error--text":this.hasError,"v-stepper__step--complete":this.complete}},hasError:function(){return this.rules.some((function(e){return!0!==e()}))}},mounted:function(){this.stepper&&this.stepper.register(this)},beforeDestroy:function(){this.stepper&&this.stepper.unregister(this)},methods:{click:function(e){e.stopPropagation(),this.$emit("click",e),this.editable&&this.stepClick(this.step)},genIcon:function(e){return this.$createElement(Z["a"],e)},genLabel:function(){return this.$createElement("div",{staticClass:"v-stepper__label"},this.$slots.default)},genStep:function(){var e=!(this.hasError||!this.complete&&!this.isActive)&&this.color;return this.$createElement("span",this.setBackgroundColor(e,{staticClass:"v-stepper__step__step"}),this.genStepContent())},genStepContent:function(){var e=[];return this.hasError?e.push(this.genIcon(this.errorIcon)):this.complete?this.editable?e.push(this.genIcon(this.editIcon)):e.push(this.genIcon(this.completeIcon)):e.push(String(this.step)),e},toggle:function(e){this.isActive=e.toString()===this.step.toString(),this.isInactive=Number(e)<Number(this.step)}},render:function(e){return e("div",{staticClass:"v-stepper__step",class:this.classes,directives:[{name:"ripple",value:this.editable}],on:{click:this.click}},[this.genStep(),this.genLabel()])}}),Object(z["h"])("v-stepper__header"),Object(z["h"])("v-stepper__items")),Y=Object(f["a"])(x,r,c,!1,null,null,null),X=Y.exports;m()(Y,{VBtn:b["a"],VCard:E["a"],VCardActions:C["a"],VCardSubtitle:C["b"],VCardText:C["c"],VCardTitle:C["d"],VCol:A["a"],VProgressLinear:O["a"],VRow:S["a"],VStepper:L,VStepperContent:D,VStepperItems:B});var H={name:"Schedules",components:{Schedule:X},computed:Object(n["a"])({},Object(T["d"])(["schedules"])),methods:{openAddSchedule:function(){return this.$router.push("/schedules/create")}}},Q=H,U=s("a523"),G=Object(f["a"])(Q,i,a,!1,null,"29079bd4",null);t["default"]=G.exports;m()(G,{VCol:A["a"],VContainer:U["a"],VRow:S["a"]})},"18bc":function(e,t,s){},"421f":function(e,t,s){"use strict";s("b601")},8836:function(e,t,s){},"9a92":function(e,t,s){"use strict";s("18bc")},b601:function(e,t,s){},da09:function(e,t,s){"use strict";s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return l})),s.d(t,"c",(function(){return o}));var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.isFertilizationTypes?s("v-radio-group",{staticClass:"my-2",attrs:{value:e.fertilizationType,row:"","hide-details":"auto"},on:{change:function(t){return e.$emit("change",t)}}},[s("v-radio",{attrs:{label:"Каждый день",value:0}}),s("v-radio",{attrs:{label:"В подменную воду",value:1}}),s("v-radio",{attrs:{label:"Комбинированная подача",value:2}})],1):e._e(),[e.FERTILIZATION_IN_TAP_WATER,e.FERTILIZATION_MIX].includes(e.fertilizationType)&&e.isWaterChange?s("v-text-field",{staticClass:"mt-4",attrs:{value:e.waterChangeVolume,type:"Number",label:"Введите объем подмены",hint:"Это нужно для подсчета дозы на подмену"},on:{input:function(t){return e.$emit("water-change",+t)}}}):e._e(),s("div",{staticClass:"d-flex mt-4"},[[e.FERTILIZATION_IN_TAP_WATER,e.FERTILIZATION_MIX].includes(e.fertilizationType)&&e.isFertilizationTypes?s("div",{staticClass:"text-subtitle-1 font-weight-medium w-50 pr-2",class:{"w-100":e.fertilizationType===e.FERTILIZATION_IN_TAP_WATER}},[e.FERTILIZATION_IN_TAP_WATER===e.fertilizationType?[e._v(" Весь объем удобрений ")]:[e._v(" Доза после подмены ")],s("v-divider")],2):e._e(),[e.FERTILIZATION_EVERY_DAY,e.FERTILIZATION_MIX].includes(e.fertilizationType)?s("div",{staticClass:"text-subtitle-1 w-50 font-weight-medium pr-2",class:{"w-100":e.fertilizationType===e.FERTILIZATION_EVERY_DAY}},[e._v(" Ежедневная доза "),s("v-divider")],1):e._e()]),e._l(e.recipesSelected,(function(t,i){return s("div",{key:i,staticClass:"d-flex justify-space-between align-center"},[[e.FERTILIZATION_IN_TAP_WATER,e.FERTILIZATION_MIX].includes(e.fertilizationType)?s("base-text-field",{staticClass:"w-50 pr-2",attrs:{value:t.amount,type:"number",label:t.name,suffix:t.volume>0||e.isFertilizer(t)?"мл":"г","hide-details":"auto"},on:{input:function(t){return e.inputRecipeAmount(t,i)}}}):e._e(),[e.FERTILIZATION_EVERY_DAY,e.FERTILIZATION_MIX].includes(e.fertilizationType)?s("base-text-field",{staticClass:"w-50 pr-2",attrs:{value:t.amountDay,type:"number",label:t.name,suffix:t.volume>0||e.isFertilizer(t)?"мл/день":"г/день","hide-details":"auto"},on:{input:function(t){return e.inputRecipeAmountDay(t,i)}}}):e._e()],1)}))],2)},a=[],n=s("5530"),r=(s("a9e3"),s("da53")),c=0,l=1,o=2,u={name:"FertilizersDoseTable",props:{fertilizationType:{type:Number,default:c},recipesSelected:{type:Array,default:function(){return[]}},days:{type:Number,default:1},waterChangeVolume:{type:Number,default:0},isFertilizationTypes:{type:Boolean,default:!0},isWaterChange:{type:Boolean,default:!0}},data:function(){return{FERTILIZATION_IN_TAP_WATER:l,FERTILIZATION_EVERY_DAY:c,FERTILIZATION_MIX:o}},methods:{isFertilizer:r["i"],inputRecipeAmount:function(e,t){var s=this.recipesSelected[t],i=""!==e?+e:"";if(this.fertilizationType===l){var a=i/this.days;this.$emit("input",t,Object(n["a"])(Object(n["a"])({},s),{},{amount:i,amountDay:a}))}else this.fertilizationType===o&&this.$emit("input",t,Object(n["a"])(Object(n["a"])({},s),{},{amount:i}))},inputRecipeAmountDay:function(e,t){var s=this.recipesSelected[t],i=""!==e?+e:"";if(this.fertilizationType===c){var a=i*this.days;this.$emit("input",t,Object(n["a"])(Object(n["a"])({},s),{},{amount:a,amountDay:i}))}else this.fertilizationType===o&&this.$emit("input",t,Object(n["a"])(Object(n["a"])({},s),{},{amountDay:i}))}}},d=u,p=(s("421f"),s("2877")),h=s("6544"),f=s.n(h),v=s("ce7e"),m=s("67b6"),b=s("43a6"),_=s("8654"),y=Object(p["a"])(d,i,a,!1,null,"249d425f",null);t["d"]=y.exports;f()(y,{VDivider:v["a"],VRadio:m["a"],VRadioGroup:b["a"],VTextField:_["a"]})}}]);
//# sourceMappingURL=chunk-5ff64aa8.6371d023.js.map